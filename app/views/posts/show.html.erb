<div class="post-container">
  <div class="post-card">
    <!-- Header của post -->
    <div class="post-header">
      <div class="user-info">
        <div class="avatar">
          <img src="https://via.placeholder.com/50x50/007bff/ffffff?text=<%= @user.email_address.first.upcase %>" alt="Avatar">
        </div>
        <div class="user-details">
          <h3 class="username"><%= @user.email_address %></h3>
          <span class="post-time"><%= time_ago_in_words(@post.created_at) %> trước</span>
        </div>
      </div>

      <div class="post-privacy">
        <% if @post.visibility == 0 %>
          <span class="privacy-badge public">
            <i class="fas fa-globe"></i> Công khai
          </span>
        <% else %>
          <span class="privacy-badge private">
            <i class="fas fa-lock"></i> Riêng tư
          </span>
        <% end %>
      </div>
    </div>

    <!-- Nội dung post -->
    <div class="post-content">
      <h2 class="post-title"><%= @post.title %></h2>
      <div class="post-text">
        <%= simple_format(@post.content) %>
      </div>
    </div>

    <!-- Thống kê post -->
    <div class="post-stats">
      <div class="stat-item">
        <i class="fas fa-comment"></i>
        <span><%= @comments.count %> bình luận</span>
      </div>
      <div class="stat-item">
        <i class="fas fa-eye"></i>
        <span>0 lượt xem</span>
      </div>
    </div>

    <!-- Actions -->
    <div class="post-actions">
      <button class="action-btn like-btn">
        <i class="far fa-heart"></i>
        <span>Thích</span>
      </button>
      <button class="action-btn comment-btn">
        <i class="far fa-comment"></i>
        <span>Bình luận</span>
      </button>
      <button class="action-btn share-btn">
        <i class="far fa-share-square"></i>
        <span>Chia sẻ</span>
      </button>
    </div>

    <!-- Phần bình luận -->
    <div class="comments-section">
      <h4>Bình luận</h4>

      <!-- Form bình luận mới -->
      <div class="comment-form">
        <div class="comment-input-wrapper">
          <img src="https://via.placeholder.com/32x32/007bff/ffffff?text=<%= Current.user.email_address.first.upcase %>" alt="Avatar" class="comment-avatar">
          <input type="text" placeholder="Viết bình luận..." class="comment-input">
          <button class="comment-submit">Gửi</button>
        </div>
      </div>

      <!-- Danh sách bình luận -->
      <div class="comments-list">
        <% if @comments.any? %>
          <% @comments.each do |comment| %>
            <div class="comment-item">
              <div class="comment-avatar">
                <img src="https://via.placeholder.com/32x32/6c757d/ffffff?text=<%= comment.user.email_address.first.upcase %>" alt="Avatar">
              </div>
              <div class="comment-content">
                <div class="comment-bubble">
                  <div class="comment-header">
                    <span class="comment-author"><%= comment.user.email_address %></span>
                    <span class="comment-time"><%= time_ago_in_words(comment.created_at) %> trước</span>
                  </div>
                  <p class="comment-text"><%= comment.content %></p>
                </div>
                <div class="comment-actions">
                  <button class="comment-action">Thích</button>
                  <button class="comment-action">Trả lời</button>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="no-comments">
            <p>Chưa có bình luận nào. Hãy là người đầu tiên bình luận!</p>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <div class="post-navigation">
    <%= link_to user_posts_path(@user), class: "nav-btn back-btn" do %>
      <i class="fas fa-arrow-left"></i>
      <span>Quay lại danh sách</span>
    <% end %>

    <% if @post.user_id == Current.user.id %>
      <%= link_to edit_user_post_path(@user, @post), class: "nav-btn edit-btn" do %>
        <i class="fas fa-edit"></i>
        <span>Chỉnh sửa</span>
      <% end %>

      <%= button_to user_post_path(@user, @post), method: :delete,
                    data: { confirm: "Bạn có chắc muốn xóa bài viết này?" },
                    class: "nav-btn delete-btn" do %>
        <i class="fas fa-trash"></i>
        <span>Xóa</span>
      <% end %>
    <% end %>
  </div>
</div>

<style>
    .post-container {
        max-width: 800px;
        margin: 20px auto;
        padding: 0 20px;
    }

    .post-card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        overflow: hidden;
        margin-bottom: 20px;
    }

    .post-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px 20px;
        border-bottom: 1px solid #f0f0f0;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .avatar img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        object-fit: cover;
    }

    .user-details .username {
        margin: 0;
        font-size: 16px;
        font-weight: 600;
        color: #1c1e21;
    }

    .post-time {
        font-size: 13px;
        color: #65676b;
    }

    .privacy-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
    }

    .privacy-badge.public {
        background: #e7f3ff;
        color: #1877f2;
    }

    .privacy-badge.private {
        background: #fff4e6;
        color: #f76707;
    }

    .post-content {
        padding: 20px;
    }

    .post-title {
        margin: 0 0 16px 0;
        font-size: 20px;
        font-weight: 600;
        color: #1c1e21;
    }

    .post-text {
        font-size: 15px;
        line-height: 1.6;
        color: #1c1e21;
    }

    .post-stats {
        display: flex;
        gap: 20px;
        padding: 12px 20px;
        border-top: 1px solid #f0f0f0;
        border-bottom: 1px solid #f0f0f0;
    }

    .stat-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        color: #65676b;
    }

    .post-actions {
        display: flex;
        padding: 8px 0;
    }

    .action-btn {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px;
        background: none;
        border: none;
        font-size: 14px;
        color: #65676b;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .action-btn:hover {
        background-color: #f2f3f4;
    }

    .comments-section {
        border-top: 1px solid #f0f0f0;
        padding: 20px;
    }

    .comments-section h4 {
        margin: 0 0 16px 0;
        font-size: 16px;
        color: #1c1e21;
    }

    .comment-form {
        margin-bottom: 20px;
    }

    .comment-input-wrapper {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .comment-avatar img {
        width: 32px;
        height: 32px;
        border-radius: 50%;
    }

    .comment-input {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #e4e6ea;
        border-radius: 20px;
        font-size: 14px;
        outline: none;
    }

    .comment-input:focus {
        border-color: #1877f2;
    }

    .comment-submit {
        padding: 8px 16px;
        background: #1877f2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
    }

    .comment-submit:hover {
        background: #166fe5;
    }

    .comments-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .comment-item {
        display: flex;
        gap: 12px;
    }

    .comment-bubble {
        background: #f2f3f4;
        padding: 12px 16px;
        border-radius: 18px;
        max-width: 100%;
    }

    .comment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 4px;
    }

    .comment-author {
        font-weight: 600;
        font-size: 13px;
        color: #1c1e21;
    }

    .comment-time {
        font-size: 12px;
        color: #65676b;
    }

    .comment-text {
        margin: 0;
        font-size: 14px;
        line-height: 1.4;
        color: #1c1e21;
    }

    .comment-actions {
        display: flex;
        gap: 12px;
        margin-top: 8px;
    }

    .comment-action {
        background: none;
        border: none;
        font-size: 12px;
        color: #65676b;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 4px;
    }

    .comment-action:hover {
        background: #e4e6ea;
    }

    .no-comments {
        text-align: center;
        padding: 20px;
        color: #65676b;
    }

    .post-navigation {
        display: flex;
        gap: 12px;
        justify-content: center;
    }

    .nav-btn {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 20px;
        border-radius: 8px;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
    }

    .back-btn {
        background: #f2f3f4;
        color: #1c1e21;
    }

    .back-btn:hover {
        background: #e4e6ea;
    }

    .edit-btn {
        background: #1877f2;
        color: white;
    }

    .edit-btn:hover {
        background: #166fe5;
    }

    .delete-btn {
        background: #dc3545;
        color: white;
        border: none;
        cursor: pointer;
    }

    .delete-btn:hover {
        background: #c82333;
    }

    @media (max-width: 768px) {
        .post-container {
            padding: 0 10px;
        }

        .post-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 12px;
        }

        .post-actions {
            flex-wrap: wrap;
        }

        .action-btn {
            min-width: 120px;
        }

        .comment-input-wrapper {
            flex-wrap: wrap;
        }

        .comment-submit {
            width: 100%;
            margin-top: 8px;
        }
    }
</style>